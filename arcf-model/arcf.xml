<?xml version='1.0' encoding='utf-8'?>

<scene version="0.5.0">

    <!-- select models -->

    <default name="sample-model"        value="qvd" />   <!-- "spectralon", qvd", or "none" -->
    <default name="monochromator-model" value="erik" />  <!-- "hole", "tube", or "erik" -->
    <default name="environment-model"   value="none" />  <!-- "full" or "none" -->

    <!-- Geometry variables -->

    <default name="detector.distance"    value="0.400"  />
    <default name="detector.motor_angle" value="90.000" />

    <bsdf type="diffuse" id="detector.outside-bsdf">
        <!--<spectrum name="reflectance" value="0"/>-->
        <!-- peculiar: if I make this black, we don't see the scene anymore from inside the diffuser.
             TODO: figure out why this is the case.
        -->
        <spectrum name="reflectance" value="1e-20"/>
    </bsdf>

    <default name="monochromator.irradiance"  value="1,1,0" />
    <default name="monochromator.radius"      value="0.010" />
    <default name="monochromator.tube_length" value="0.040" />
    <default name="monochromator.distance"    value="0.600" />

    <bsdf type="diffuse" id="monochromator.outside-bsdf">
        <!--<spectrum name="reflectance" value="0"/>-->
        <!-- peculiar: if we make this black, we don't see the scene anymore from inside the diffuser.
             TODO: figure out why this is the case.
        -->
        <spectrum name="reflectance" value="1e-20"/>
    </bsdf>

    <default name="meris.high_motor_angle"   value="0" />
    <default name="meris.middle_motor_angle" value="0" />
    <default name="meris.low_motor_angle"    value="+45" />

    <!-- include stuff -->

    <include filename="colors.xml"/>
    <include filename="axes.xml"/>

    <include filename="detector.xml"/>
    <include filename="monochromator-$monochromator-model.xml"/>
    <include filename="sample-$sample-model.xml"/>
    <include filename="environment-$environment-model.xml"/>

    <!-- monochromator beam inhomogeneity mask -->
    <!--
    <shape type="rectangle">

        <bsdf type="mask">

            <texture name="opacity" type="bitmap">
                <string name="filename" value="testmask-negated.png"/>
                <string name="wrapMode" value="zero"/>
                <!- uscale == -1. uoffset=+1 ->
                <float name="uscale" value="+1"/>
                <float name="vscale" value="-1"/>
                <float name="uoffset" value="0"/>
                <float name="voffset" value="+1"/>
            </texture>

            <bsdf type="diffuse">
                <spectrum name="reflectance" value="0"/>
            </bsdf>

        </bsdf>

        <transform name="toWorld">
            <scale value="0.01"/>
            <translate z="0.55"/>
        </transform>
    </shape>
    -->

    <integrator type="bdpt" />

    <!--
    <sensor type="perspective" id="overview">

        <float name="fov" value="45"/>

        <transform name="toWorld">
            <lookat origin="3,0,1" target="0,0,0" up="0,1,0"/>
        </transform>

        <sampler type="independent">
            <integer name="sampleCount" value="8"/>
        </sampler>

        <film type="hdrfilm">
            <boolean name="banner" value="false"/>
            <integer name="width" value="960"/>
            <integer name="height" value="540"/>
        </film>

    </sensor>
    -->

</scene>
