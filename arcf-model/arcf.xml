<?xml version='1.0' encoding='utf-8'?>

<scene version="0.5.0">

    <!-- select models -->

    <default name="sample-model"        value="spectralon" />
    <default name="monochromator-model" value="erik" />

    <!-- Geometry variables -->

    <default name="detector.distance"    value="0.400"  />
    <default name="detector.motor_angle" value="45.000" />

    <bsdf type="diffuse" id="detector.outside-bsdf.old">
        <!--<spectrum name="reflectance" value="0"/>-->
        <!-- peculiar: if I make this black, we don't see the scene anymore from inside the diffuser.
             TODO: figure out why this is the case.
        -->
        <rgb name="reflectance" value="#ffff00"/>
    </bsdf>

    <bsdf type="roughconductor" id="detector.outside-bsdf">
        <!--<spectrum name="reflectance" value="0"/>-->
        <!-- peculiar: if I make this black, we don't see the scene anymore from inside the diffuser.
             TODO: figure out why this is the case.
        -->
        <string name="material" value="Au"/>
    </bsdf>

    <default name="monochromator.intensity"   value="1" />
    <default name="monochromator.radius"      value="0.010" />
    <default name="monochromator.tube_length" value="0.040" />
    <default name="monochromator.distance"    value="0.600" />

    <bsdf type="diffuse" id="monochromator.outside-bsdf.old">
        <rgb name="reflectance" value="#ff00ff"/>
    </bsdf>

    <bsdf type="roughconductor" id="monochromator.outside-bsdf">
        <string name="material" value="Ag"/>
    </bsdf>

    <default name="meris.high_motor_angle"   value="0" />
    <default name="meris.middle_motor_angle" value="0" />
    <default name="meris.low_motor_angle"    value="70" />

    <!-- include stuff -->

    <include filename="colors.xml"/>
    <include filename="axes.xml"/>

    <include filename="detector.xml"/>
    <include filename="monochromator-$monochromator-model.xml"/>
    <include filename="sample-$sample-model.xml"/>
    <include filename="environment.xml"/>

    <!-- monochromator beam inhomogeneity mask -->
    <!--
    <shape type="rectangle">

        <bsdf type="mask">

            <texture name="opacity" type="bitmap">
                <string name="filename" value="testmask-negated.png"/>
                <string name="wrapMode" value="zero"/>
                <float name="uscale" value="-1"/>
                <float name="vscale" value="-1"/>
                <float name="uoffset" value="1"/>
                <float name="voffset" value="+1"/>
            </texture>

            <bsdf type="diffuse">
                <spectrum name="reflectance" value="0"/>
            </bsdf>

        </bsdf>

        <transform name="toWorld">
            <scale value="0.01"/>
            <translate z="0.55"/>
        </transform>
    </shape>
    -->

    <integrator type="bdpt">
        <!--<integer name="rrDepth" value="12"/>-->
    </integrator>

    <sensor type="perspective" id="overview">

        <float name="fov" value="45"/>

        <transform name="toWorld">
            <lookat origin="0.20,0.20,1.20" target="0,0,0" up="0,1,0"/>
        </transform>

        <sampler type="independent">
            <integer name="sampleCount" value="16"/>
        </sampler>

        <film type="hdrfilm">
            <boolean name="banner" value="false"/>
            <integer name="width" value="960"/>
            <integer name="height" value="540"/>
        </film>

    </sensor>

    <!--
    <shape type="instance">
        <ref id="axes"/>
        <transform name="toWorld">
            <scale value="1"/>
        </transform>
    </shape>
    -->

</scene>
